<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<script src="../js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<body>
		<div id="wrapper">       
		  	<input id="fileUpload" type="file" multiple /><br />
		  	<div id="image-holder"> </div>
		</div>
		
		
<script type="text/javascript">
	//单个图片上传
	/*$("#fileUpload").on('change', function () {
	    if (typeof (FileReader) != "undefined") {
	        var image_holder = $("#image-holder");
	        image_holder.empty();
	        var reader = new FileReader();
	        reader.onload = function (e) {
	            $("<img />", {
	                "src": e.target.result,
	                "class": "thumb-image"
	            }).appendTo(image_holder);
	        }
	        image_holder.show();
	        reader.readAsDataURL($(this)[0].files[0]);
	    } else {
	        alert("你的浏览器不支持FileReader.");
	    }
	});*/
	
	
	//多图上传
//	要想实现多张图片预览效果，必须在文件上传标签中添加multiple属性，使它可以选择多张图片。
	$("#fileUpload").on('change', function () {
	   //获取上传文件的数量
	   var countFiles = $(this)[0].files.length;
	   console.log(countFiles);
	   if(countFiles>4){
	   		alert("最多只能上传4张图片");
	   }else{
		   	var imgPath = $(this)[0].value;
		   	var extn = imgPath.substring(imgPath.lastIndexOf('.') + 1).toLowerCase();
		   	var image_holder = $("#image-holder");
		   	image_holder.empty();
		   	if (extn == "gif" || extn == "png" || extn == "jpg" || extn == "jpeg") {
		   	    if (typeof (FileReader) != "undefined") {
		   	        // 循环所有要上传的图片
		   	        for (var i = 0; i < countFiles; i++) {
		   	            var reader = new FileReader();
		   	            reader.onload = function (e) {
		   	                $("<img />",{
		   	                    "src": e.target.result,
		   	                        "class": "thumb-image"
		   	                }).appendTo(image_holder);
		   	            }
		   	            image_holder.show();
//		   	            var imges=str.split(",");//以逗号分割字符串
		   	            reader.readAsDataURL($(this)[0].files[i]);
		   	        }
		   	    } else {
		   	        alert("你的浏览器不支持FileReader！");
		   	    }
		   	} else {
		   	    alert("请选择图像文件。");
		   	}
	   }
	});
</script>
	</body>
</html>
